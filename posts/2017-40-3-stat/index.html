<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		 
			
  
    <meta name="twitter:card" content="summary"/>
    
      <meta name="twitter:image" content="https://vmresu.me/images/avatar.png" />
    
  
  
  <meta name="twitter:title" content="Struct stat notes"/>
  <meta name="twitter:description" content="Note: i&rsquo;m going to try a significantly more informal blogging style
 struct stat on Linux is pretty interesting
 the struct definition in the man page is not exactly accurate glibc explicitly pads the struct with unused members which is intersting. I guess to reserve space for expansion of fields  if you want to see the real definition, a trick you can use is writing a test program that uses a struct stat, and compiling with -E to stop after preprocessing then look in that output for the definition  you can look in the glibc sources and the linux sources and see that they actually have to make their struct definitions match!"/>
  
    <meta name="twitter:site" content="@offlinemark"/>
  
  
  
  
    <meta name="twitter:creator" content="@Mark Mossberg"/>
  



		
		<meta name="author" content="Mark Mossberg">
		<meta name="description" content="Hacker Nonsense">
		<meta name="generator" content="Hugo 0.59.0" />
		<title>Struct stat notes &middot; Mark Mossberg&#39;s Blog</title>
		<link rel="shortcut icon" href="https://vmresu.me/images/favicon.ico">
		<link rel="stylesheet" href="https://vmresu.me/css/style.css">
		<link rel="stylesheet" href="https://vmresu.me/css/highlight.css">

		
		<link rel="stylesheet" href="https://vmresu.me/css/font-awesome.min.css">
		

		
		<link href="https://vmresu.me/index.xml" rel="alternate" type="application/rss+xml" title="Mark Mossberg&#39;s Blog" />
		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://vmresu.me/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://vmresu.me/posts'>Archive</a>
	<a href='https://vmresu.me/tags'>Tags</a>
	<a href='https://vmresu.me/about'>About</a>

	

	
	
	<a  href="https://vmresu.me/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        Struct stat notes
                    </h1>
                    <h2 class="headline">
                    Apr 20, 2017
                    · 187 words
                    · 1 minute read
                      <span class="tags">
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    <blockquote>
<p>Note: i&rsquo;m going to try a significantly more informal blogging style</p>
</blockquote>

<p><code>struct stat</code> on Linux is pretty interesting</p>

<ul>
<li>the struct definition in the man page is not exactly accurate</li>
<li>glibc explicitly pads the struct with unused members which is intersting. I guess to reserve space for expansion of fields

<ul>
<li>if you want to see the real definition, a trick you can use is writing a test program that uses a struct stat, and compiling with <code>-E</code> to stop after preprocessing then look in that output for the definition</li>
</ul></li>
<li>you can look in the glibc sources and the linux sources and see that they actually have to make their struct definitions match! (i think). since kernel space is populating the struct memory and usespace is using it, they need to exactly agree on where what members are

<ul>
<li>you can find some snarky comments in linux about the padding, which is pretty funny. for example (arch/arm/include/uapi/asm/stat.h)</li>
</ul></li>
<li>because the structs are explicitly padded, if you do a struct designator initialization, you CANNOT omit the designators. if you do, the padded members will be initialized instead of the fields you wanted!</li>
</ul>

                </section>
            </article>

            
                <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fvmresu.me%2fposts%2f2017-40-3-stat%2f - Struct%20stat%20notes by @offlinemark"><span class="icon-twitter"> tweet</span></a> | 

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

            

            
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'your_disqus_short_name'; 

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

            

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://www.github.com/mossberg">
        <i class="fa fa-github-square"></i>
    </a>
    
    <a class="symbol" href="https://www.twitter.com/offlinemark">
        <i class="fa fa-twitter-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2019 <i class="fa fa-heart" aria-hidden="true"></i> Mark Mossberg
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>

        <script src="https://vmresu.me/js/jquery-3.3.1.min.js"></script>
<script src="https://vmresu.me/js/main.js"></script>
<script src="https://vmresu.me/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-36552439-2', 'auto');
	
	ga('send', 'pageview');
}
</script>





    </body>
</html>
